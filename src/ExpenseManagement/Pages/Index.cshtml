@page
@model IndexModel
@{
    ViewData["Title"] = "Dashboard";
}

<div class="text-center">
    <h1 class="display-4">Expense Management System</h1>
    <p class="lead">Manage your business expenses efficiently</p>
</div>

@if (Model.ErrorMessage != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <h4 class="alert-heading">⚠️ Database Connection Error</h4>
        <p><strong>@Model.ErrorMessage</strong></p>
        <hr>
        <p class="mb-0">
            This error typically occurs when:
        </p>
        <ul>
            <li>The AZURE_CLIENT_ID environment variable is not set</li>
            <li>The connection string is missing the User Id parameter</li>
            <li>The managed identity doesn't have database permissions</li>
        </ul>
        <p class="mb-0">
            <strong>Showing dummy data instead.</strong> Once the database connection is fixed, real data will appear.
        </p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="row mt-5">
    @if (Model.Summary != null && Model.Summary.Count > 0)
    {
        foreach (var item in Model.Summary)
        {
            <div class="col-md-3 mb-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h5 class="card-title">@item.StatusName</h5>
                        <h2 class="text-primary">@item.Count</h2>
                        <p class="text-muted">£@item.TotalAmount.ToString("N2")</p>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12">
            <div class="alert alert-info">
                <p>No expense data available yet.</p>
            </div>
        </div>
    }
</div>

<div class="row mt-4">
    <div class="col-md-4 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">📋 View Expenses</h5>
                <p class="card-text">Browse all expenses, filter by status, and search for specific items.</p>
                <a href="/ViewExpenses" class="btn btn-primary">View Expenses</a>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">➕ Add Expense</h5>
                <p class="card-text">Submit a new expense for approval by entering amount, date, and category.</p>
                <a href="/AddExpense" class="btn btn-success">Add New Expense</a>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">✅ Approve Expenses</h5>
                <p class="card-text">Review and approve or reject submitted expenses from team members.</p>
                <a href="/ApproveExpenses" class="btn btn-warning">Review Expenses</a>
            </div>
        </div>
    </div>
</div>

<div class="row mt-3">
    <div class="col-md-6 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">🤖 AI Chat Assistant</h5>
                <p class="card-text">Use natural language to query expenses, create new ones, or get insights.</p>
                <a href="/Chat" class="btn btn-info">Open Chat</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">📚 API Documentation</h5>
                <p class="card-text">Explore the REST API using Swagger UI for integration with other systems.</p>
                <a href="/swagger" class="btn btn-secondary">View API Docs</a>
            </div>
        </div>
    </div>
</div>
